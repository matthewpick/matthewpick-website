---
import BaseLayout from './BaseLayout.astro';
import GenerativeHero from '../components/GenerativeHero.astro';

interface Props {
  title: string;
  description: string;
  pubDate: Date;
  heroImage?: string;
  slug: string;
}

const { title, description, pubDate, heroImage, slug } = Astro.props;
const formattedDate = pubDate.toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});
---

<BaseLayout title={title} description={description} image={heroImage}>
  <article class="py-12">
    <div class="max-w-3xl mx-auto px-4">
      <header class="mb-8">
        <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-accent-subtle text-accent text-sm font-medium mb-4">
          {formattedDate}
        </div>
        <h1 class="text-3xl md:text-4xl font-bold text-primary mb-6">
          {title}
        </h1>
        <div class="aspect-[5/2] overflow-hidden rounded-xl border border-border">
          {heroImage ? (
            <img src={heroImage} alt="" class="w-full h-full object-cover" />
          ) : (
            <GenerativeHero slug={slug} />
          )}
        </div>
      </header>

      <div class="prose prose-lg max-w-none prose-themed">
        <slot />
      </div>

      <footer class="mt-12 pt-8 border-t border-border">
        <a href="/" class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-subtle text-accent hover:bg-border-hover transition-colors">
          <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
          </svg>
          Back to all posts
        </a>
      </footer>
    </div>
  </article>
</BaseLayout>

<style is:global>
  .gist {
    margin: 1.5rem 0;
  }

  .gist .gist-file {
    border-radius: 0.75rem;
    overflow: hidden;
    border: 1px solid #253D30;
  }

  .dark .gist .gist-data {
    background-color: #1A2B22;
  }

  .dark .gist .gist-meta {
    background-color: #0F1A14;
    color: #F5F7F4;
    border-top: 1px solid #253D30;
  }

  .dark .gist .gist-meta a {
    color: #A3B896;
  }

  .dark .gist .blob-code,
  .dark .gist .blob-num {
    background-color: #1A2B22;
  }

  /* Remove zebra striping */
  .dark .gist tr:nth-child(odd) .blob-code,
  .dark .gist tr:nth-child(even) .blob-code,
  .dark .gist tr:nth-child(odd) .blob-num,
  .dark .gist tr:nth-child(even) .blob-num,
  .dark .gist .highlight tr:nth-child(odd),
  .dark .gist .highlight tr:nth-child(even) {
    background-color: #1A2B22 !important;
    border: none;
  }

  .dark .gist .blob-code {
    border-left: none !important;
  }

  /* Dark mode syntax highlighting overrides */
  .dark .gist .blob-num {
    color: #6B8F74;
    border-right: 1px solid #253D30;
  }

  .dark .gist .blob-code-inner {
    color: #F5F7F4;
  }

  .dark .gist .pl-c {
    color: #6B8F74;
  }

  .dark .gist .pl-k,
  .dark .gist .pl-s .pl-s1 {
    color: #D4896F;
  }

  .dark .gist .pl-en {
    color: #A3B896;
  }

  .dark .gist .pl-s,
  .dark .gist .pl-pds {
    color: #A3B896;
  }

  .dark .gist .pl-smi,
  .dark .gist .pl-s .pl-pse .pl-s1 {
    color: #F5F7F4;
  }

  .dark .gist .pl-ent {
    color: #6B8F74;
  }

  .dark .gist .pl-c1,
  .dark .gist .pl-v {
    color: #D4896F;
  }
</style>
